<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MindGrade â€” Daily Test Marks Grader</title>
<style>
:root{--bg:#0f1724;--card:#0b1220;--accent:#10b981;--muted:#98a0b3}
*{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
html,body{height:100%;margin:0;background:linear-gradient(180deg,#071024 0%, #081428 60%);color:#e6eef8}
.app{min-height:100vh;display:flex;gap:20px;padding:28px}
.bg-text{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:none;z-index:0}
.bg-text h1{font-size:clamp(48px,12vw,180px);opacity:.06;letter-spacing:6px;margin:0}
.sidebar{width:360px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;padding:18px;z-index:2}
.main{flex:1;z-index:2}
.card{background:rgba(255,255,255,0.02);padding:14px;border-radius:10px;margin-bottom:14px}
h2{margin:0 0 10px 0;font-size:18px}
label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
input[type=text], input[type=number]{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
button{cursor:pointer;padding:8px 12px;border-radius:8px;border:0;background:var(--accent);color:#012;font-weight:600}
.user-list{display:flex;flex-direction:column;gap:8px}
.user-item{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:8px;background:rgba(0,0,0,0.18)}
.controls{display:flex;gap:8px;flex-wrap:wrap}
.export{background:transparent;border:1px solid rgba(255,255,255,0.06)}
footer{margin-top:12px;color:var(--muted);font-size:13px}
</style>
</head>
<body>
<div class="bg-text"><h1>It Is All In The Mind</h1></div>
<div class="app">
<div class="sidebar card">
<h2>Squad</h2>
<div style="display:flex;gap:8px;margin-bottom:10px">
<input id="newName" type="text" placeholder="Add friend (name)" />
<button id="addBtn">Add</button>
</div>
<div class="user-list" id="userList"></div>
<div class="card" style="margin-top:12px">
<label>Today's Tests</label>
<input id="test1" type="number" placeholder="Test 1 marks (0-100)" />
<input id="test2" type="number" placeholder="Test 2 marks (0-100)" style="margin-top:6px" />
<button id="submitMarks" class="small" style="margin-top:6px">Submit Marks</button>
</div>
<footer>Tip: Data is private until all users submit or skip.</footer>
</div>
<div class="main">
<div class="card">
<h2>Today's Rankings</h2>
<div id="rankings"></div>
</div>
</div>
</div>
<script>
const STORAGE_KEY = 'mindgrade_private'
let state = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{"users":[],"marks":{},"submitted":{}}')

const userList = document.getElementById('userList')
const newName = document.getElementById('newName')
const addBtn = document.getElementById('addBtn')
const test1 = document.getElementById('test1')
const test2 = document.getElementById('test2')
const submitMarks = document.getElementById('submitMarks')
const rankings = document.getElementById('rankings')

addBtn.onclick = ()=>{
  const name = newName.value.trim()
  if(!name) return alert('Enter a name')
  if(state.users.includes(name)) return alert('Already added')
  state.users.push(name)
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state))
  newName.value=''
  renderUsers()
}

function renderUsers(){
  userList.innerHTML=''
  state.users.forEach(name=>{
    const el = document.createElement('div')
    el.className='user-item'
    el.textContent=name
    userList.appendChild(el)
  })
}

submitMarks.onclick = ()=>{
  const t1 = Number(test1.value), t2 = Number(test2.value)
  if(isNaN(t1)||isNaN(t2)) return alert('Enter marks for both tests')
  const total = t1+t2
  const currentUser = prompt('Enter your name')
  if(!currentUser || !state.users.includes(currentUser)) return alert('Name not in list')
  state.marks[currentUser] = {t1,t2,total}
  state.submitted[currentUser] = true
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state))
  alert('Marks submitted! They are private until all submit.')
  test1.value=''
  test2.value=''
  renderRankings()
}

function renderRankings(){
  const allSubmitted = state.users.every(u=>state.submitted[u])
  rankings.innerHTML=''
  if(!allSubmitted){
    rankings.textContent='Waiting for everyone to submit or skip.'
    return
  }
  const totals = state.users.map(u=>({name:u,total:state.marks[u].total})).sort((a,b)=>b.total-a.total)
  const displayRanks = []
  for(let i=0;i<totals.length;i++){
    let score = 0
    if(totals[i].total>=20){
      if(i===0) score=3
      else if(i===1) score=2
      else if(i===2) score=1
      else score=0
      if(totals[i].total===200) score+=1 // extra point if 100/100 in both tests
    }
    displayRanks.push({name:totals[i].name,score})
  }
  let html=''
  displayRanks.forEach(d=>{
    html+=`<div>${d.name} - ${d.score}</div>`
  })
  rankings.innerHTML=html
}

renderUsers()
renderRankings()
</script>
</body>
</html>
